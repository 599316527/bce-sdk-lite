{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?9b05","webpack:///./src/App.vue?08fb","webpack:///../lib/crypto.js","webpack:///../lib/headers.js","webpack:///../lib/strings.js","webpack:///../lib/Auth.js","webpack:///../lib/EventBus.js","webpack:///../lib/HttpClient.js","webpack:///../lib/BosClient.js","webpack:///src/App.vue","webpack:///./src/App.vue?a7d1","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","_v","isUploading","on","handleFileChange","file","handleUploadButtonClick","handleCancelButtonClick","_e","staticClass","_s","progressText","error","url","staticRenderFns","i2hex","toString","stringToUint8Array","str","buf","ArrayBuffer","bufView","Uint8Array","strLen","charCodeAt","uint8ArrayToString","uint8","reduce","memo","sha256hmac","hmac","CONTENT_TYPE","CONTENT_LENGTH","CONTENT_MD5","CONTENT_ENCODING","CONTENT_DISPOSITION","ETAG","HOST","CACHE_CONTROL","EXPIRES","AUTHORIZATION","X_BCE_DATE","X_BCE_ACL","X_BCE_GRANT_READ","X_BCE_GRANT_FULL_CONTROL","X_BCE_CONTENT_SHA256","X_BCE_OBJECT_ACL","X_BCE_OBJECT_GRANT_READ","X_HTTP_HEADERS","X_BODY","X_STATUS_CODE","X_MESSAGE","X_CODE","SESSION_TOKEN","kEscapedMap","'","uriEncode","string","encodingSlash","encodeURIComponent","replace","$1","byteSize","Blob","size","normalizePath","parts","split","ret","part","trim","test","Math","max","join","defaultHeadersToSign","Auth","ak","sk","method","resource","params","headers","now","Date","expirationInSeconds","headersToSign","rawSessionKey","toISOString","sessionKey","canonicalUri","uriCanonicalization","canonicalQueryString","queryStringCanonicalization","headersCanonicalization","canonicalHeaders","signedHeaders","rawSignature","signature","uri","keys","toLowerCase","concat","sort","headersMap","map","h","EventBus","_events","func","filter","f","args","funcs","forEach","HttpClient","config","_client","axios","baseURL","endpoint","onUploadProgress","updateProgress","httpMethod","path","body","signFunction","toUpperCase","options","credentials","createSignature","_doRequest","request","responseType","cancelToken","CancelToken","cancel","_cancelRequest","response","Promise","reject","status","failure","responseBody","parseHttpResponseBody","err","requestId","message","code","date","success","fixHeaders","progressEvent","emit","auth","generateAuthorization","httpHeaders","statusCode","xBceDate","X_REQUEST_ID","raw","contentType","JSON","parse","MAX_PUT_OBJECT_LENGTH","MAX_USER_METADATA_SIZE","allowedHeaders","defaultRequestArgs","bucketName","BosClient","revisionTimestamp","timeOffset","TypeError","_checkOptions","sendRequest","blob","putObject","varArgs","sessionToken","sendHTTPRequest","httpContext","doRequest","agent","evt","cancelRequest","promise","abort","serverTimestamp","getTime","allowedParams","_prepareObjectHeaders","metaSize","contentLength","etag","ETag","progress","computed","isFail","isSuccess","round","methods","target","files","handleClientProgress","loaded","total","client","mounted","beforeDestroy","off","getExt","substring","getContentType","ext","includes","component","Vue","productionTip","render","App","$mount"],"mappings":"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","file":"js/app.bf2369bd.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('h1',[_vm._v(\"BosClient.putObjectFromBlob()\")]),_c('div',[_c('input',{attrs:{\"type\":\"file\",\"disabled\":_vm.isUploading},on:{\"change\":_vm.handleFileChange}}),_c('button',{attrs:{\"disabled\":!_vm.file || _vm.isUploading},on:{\"click\":_vm.handleUploadButtonClick}},[_vm._v(\"Upload\")]),(_vm.file && _vm.isUploading)?_c('button',{on:{\"click\":_vm.handleCancelButtonClick}},[_vm._v(\"Cancel\")]):_vm._e()]),(_vm.isUploading)?_c('div',{staticClass:\"loading\"},[_vm._v(\"上传中 \"+_vm._s(_vm.progressText))]):_vm._e(),(_vm.isFail)?_c('div',{staticClass:\"error\"},[_vm._v(\"上传失败：\"+_vm._s(_vm.error))]):_vm._e(),(_vm.isSuccess)?_c('div',{staticClass:\"success\"},[_vm._v(\"上传成功! \"),_c('a',{attrs:{\"href\":_vm.url,\"target\":\"_blank\"}},[_vm._v(\"打开\")])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import {hmac} from 'fast-sha256';\n\nfunction i2hex(i) {\n    return ('0' + i.toString(16)).slice(-2);\n}\n\n// https://developers.google.com/web/updates/2012/06/How-to-convert-ArrayBuffer-to-and-from-String\nfunction stringToUint8Array(str) {\n    var buf = new ArrayBuffer(str.length);\n    var bufView = new Uint8Array(buf);\n    for (var i=0, strLen=str.length; i < strLen; i++) {\n      bufView[i] = str.charCodeAt(i);\n    }\n    return bufView;\n}\n\nfunction uint8ArrayToString(uint8) {\n    return uint8.reduce(function(memo, i) {return memo + i2hex(i)}, '');\n}\n\nexport function sha256hmac(key, data) {\n    // var crypto = require('crypto');\n    // var sha256Hmac = crypto.createHmac('sha256', key);\n    // sha256Hmac.update(data);\n    // return sha256Hmac.digest('hex');\n\n    let d = hmac(stringToUint8Array(key), stringToUint8Array(data));\n    return uint8ArrayToString(d);\n}\n","\nexport const CONTENT_TYPE = 'Content-Type';\nexport const CONTENT_LENGTH = 'Content-Length';\nexport const CONTENT_MD5 = 'Content-MD5';\nexport const CONTENT_ENCODING = 'Content-Encoding';\nexport const CONTENT_DISPOSITION = 'Content-Disposition';\nexport const ETAG = 'ETag';\nexport const CONNECTION = 'Connection';\nexport const HOST = 'Host';\nexport const USER_AGENT = 'User-Agent';\nexport const CACHE_CONTROL = 'Cache-Control';\nexport const EXPIRES = 'Expires';\n\nexport const AUTHORIZATION = 'Authorization';\nexport const X_BCE_DATE = 'x-bce-date';\nexport const X_BCE_ACL = 'x-bce-acl';\nexport const X_BCE_GRANT_READ = 'x-bce-grant-read';\nexport const X_BCE_GRANT_FULL_CONTROL = 'x-bce-grant-full-control';\nexport const X_BCE_REQUEST_ID = 'x-bce-request-id';\nexport const X_BCE_CONTENT_SHA256 = 'x-bce-content-sha256';\nexport const X_BCE_OBJECT_ACL = 'x-bce-object-acl';\nexport const X_BCE_OBJECT_GRANT_READ = 'x-bce-object-grant-read';\n\nexport const X_HTTP_HEADERS = 'http_headers';\nexport const X_BODY = 'body';\nexport const X_STATUS_CODE = 'status_code';\nexport const X_MESSAGE = 'message';\nexport const X_CODE = 'code';\nexport const X_REQUEST_ID = 'request_id';\n\nexport const SESSION_TOKEN = 'x-bce-security-token';\n\nexport const X_VOD_MEDIA_TITLE = 'x-vod-media-title';\nexport const X_VOD_MEDIA_DESCRIPTION = 'x-vod-media-description';\nexport const ACCEPT_ENCODING = 'accept-encoding';\nexport const ACCEPT = 'accept';\n\n\n\n\n\n\n\n\n\n\n\n","const kEscapedMap = {\n    '!': '%21',\n    '\\'': '%27',\n    '(': '%28',\n    ')': '%29',\n    '*': '%2A'\n};\n\nexport function uriEncode(string, encodingSlash = true) {\n    let result = encodeURIComponent(string);\n    result = result.replace(/[!'\\(\\)\\*]/g, function ($1) {\n        return kEscapedMap[$1];\n    });\n\n    if (!encodingSlash) {\n        result = result.replace(/%2F/gi, '/');\n    }\n\n    return result;\n}\n\nexport function byteSize(str) {\n    // https://dev.to/rajnishkatharotiya/get-byte-size-of-the-string-in-javascript-20jm\n    return new Blob([str]).size;\n}\n\nexport function normalizePath(str) {\n    let parts = str.split('/');\n    let i = 0;\n    let ret = parts.reduce(function (ret, part) {\n        part = part.trim();\n        if (/^\\.{2,}$/.test(part)) {\n            i = Math.max(0, i - 1);\n        }\n        else if (part && part !== '.') {\n            ret[i++] = part;\n        }\n        return ret;\n    }, []);\n    ret = ret.slice(0, i);\n    return `/${ret.join('/')}`;\n}\n\n\n","import {entries, fromPairs, isString, startsWith} from 'lodash';\nimport {sha256hmac} from './crypto';\nimport {AUTHORIZATION, HOST, CONTENT_MD5, CONTENT_LENGTH, CONTENT_TYPE} from './headers';\nimport {uriEncode} from './strings';\n\nconst defaultHeadersToSign = [HOST, CONTENT_MD5, CONTENT_LENGTH, CONTENT_TYPE];\n\n// migrate from https://github.com/baidubce/bce-sdk-js/blob/master/src/auth.js\n\nexport default class Auth {\n    constructor(ak, sk) {\n        this.ak = ak;\n        this.sk = sk;\n    }\n\n    generateAuthorization(method, resource, params,\n        headers, now = new Date(), expirationInSeconds = 1800, headersToSign) {\n\n        let rawSessionKey = [\n            'bce-auth-v1',\n            this.ak,\n            now.toISOString().replace(/\\.\\d+Z$/, 'Z'),\n            expirationInSeconds\n        ].join('/');\n        let sessionKey = sha256hmac(this.sk, rawSessionKey);\n\n        let canonicalUri = this.uriCanonicalization(resource);\n        let canonicalQueryString = this.queryStringCanonicalization(params || {});\n\n        let [canonicalHeaders, signedHeaders] = this.headersCanonicalization(headers || {}, headersToSign);\n\n        let rawSignature = [method, canonicalUri, canonicalQueryString, canonicalHeaders].join('\\n');\n        let signature = sha256hmac(sessionKey, rawSignature);\n\n        return [rawSessionKey, signedHeaders.join(';'), signature].join('/');\n    }\n\n    uriCanonicalization(uri) {\n        return uri;\n    }\n\n    queryStringCanonicalization(params) {\n        let canonicalQueryString = Object.keys(params).reduce(function (ret, key) {\n            if (key.toLowerCase() === AUTHORIZATION.toLowerCase()) {\n                return ret;\n            }\n\n            let value = params[key] == null ? '' : params[key];\n            return ret.concat(key + '=' + uriEncode(value));\n        }, []);\n\n        return canonicalQueryString.sort().join('&');\n    }\n\n    headersCanonicalization(headers, headersToSign = defaultHeadersToSign) {\n        const headersMap = fromPairs(headersToSign.map(h => [h.toLowerCase(), true]));\n        let canonicalHeaders = entries(headers).reduce(function (ret, [key, value]) {\n            key = key.toLowerCase();\n            value = isString(value) ? value.trim() : value;\n            if (value !== null && value !== ''\n                && (startsWith(key, 'x-bce-') || headersMap[key] === true)) {\n                return ret.concat([key, value].map(uriEncode).join(':'));\n            }\n            return ret;\n        }, []);\n\n        canonicalHeaders.sort();\n\n        let signedHeaders = canonicalHeaders.map(h => h.split(':')[0]);\n        return [canonicalHeaders.join('\\n'), signedHeaders];\n    }\n\n}\n","import {includes} from 'lodash';\n\nexport default class EventBus {\n    constructor() {\n        this._events = {};\n    }\n\n    on(name, func) {\n        if (!this._events[name]) {\n            this._events[name] = [];\n        }\n        if (includes(this._events[name], func)) {\n            return;\n        }\n        this._events[name].push(func);\n    }\n\n    off(name, func) {\n        if (!func) {\n            this._events[name] = [];\n            return;\n        }\n        this._events[name] = this._events[name].filter(function (f) {\n            return f !== func;\n        });\n    }\n\n    emit(name, ...args) {\n        let funcs = this._events[name] || [];\n        funcs.forEach(func => func(...args));\n    }\n}","import {entries} from 'lodash';\nimport axios from 'axios';\nimport EventBus from './EventBus';\nimport {\n    AUTHORIZATION,\n    CONTENT_TYPE,\n    X_BCE_DATE,\n    X_CODE,\n    X_STATUS_CODE,\n    X_MESSAGE,\n    X_HTTP_HEADERS,\n    X_BODY\n} from './headers';\n\n\nexport default class HttpClient extends EventBus {\n    constructor(config) {\n        super();\n        this.config = config;\n\n        this._client = axios.create({\n            baseURL: this.config.endpoint,\n            headers: {\n                [CONTENT_TYPE]: 'application/json; charset=UTF-8',\n            },\n            onUploadProgress: this.updateProgress.bind(this),\n        });\n    }\n\n    sendRequest(httpMethod, path, body, headers, params, signFunction) {\n        httpMethod = httpMethod.toUpperCase();\n\n        let options = {\n            url: path,\n            method: httpMethod,\n            params,\n        };\n\n        // Prepare the request headers.\n        options.headers = {\n            ...headers,\n            [X_BCE_DATE]: new Date().toISOString().replace(/\\.\\d+Z$/, 'Z'),\n        };\n\n        if (typeof signFunction === 'function') {\n            options.headers[AUTHORIZATION] = signFunction(this.config.credentials, httpMethod, path, params, headers);\n        }\n        else {\n            options.headers[AUTHORIZATION] = createSignature(this.config.credentials, httpMethod, path, params, headers);\n        }\n\n        // TODO: unsafe headers 处理\n        // bce-sdk-js 用的 http(s)-browserify 里面搞了过滤如果是 unsafe 头就不调用 setRequestHeader\n        // 但是 axios 里面没有处理这个，导致会触发一个 console 报错（但不影响功能），要隐藏这个报错的话就也要实现下这个\n        // https://github.com/browserify/http-browserify/blob/17b2990010ebd39461d1117c1e2c50c25eab869f/lib/request.js#L44\n        // https://github.com/axios/axios/blob/ffea03453f77a8176c51554d5f6c3c6829294649/lib/adapters/xhr.js#L132\n        return this._doRequest(options, body);\n    }\n\n    async _doRequest(options, body) {\n        let response;\n        try {\n            response = await this._client.request({\n                ...options,\n                data: body,\n                responseType: 'text',\n                cancelToken: new axios.CancelToken(cancel => {\n                    this._cancelRequest = cancel;\n                }),\n            });\n        }\n        catch(error) {\n            if (!error.response) {\n                return Promise.reject(error);\n            }\n\n            let {status, data, headers} = error.response;\n            if (status >= 100 && status < 200) {\n                return Promise.reject(failure(status, 'Can not handle 1xx http status code.'));\n            }\n            else if (status < 100 || status >= 300) {\n                let responseBody;\n                try {\n                    responseBody = parseHttpResponseBody(data, headers);\n                }\n                catch (err) {};\n                if (responseBody.requestId) {\n                    let {message, code, requestId} = responseBody;\n                    return Promise.reject(failure(status, message, code, requestId, headers.date));\n                }\n                else {\n                    return Promise.reject(failure(status, responseBody));\n                }\n            }\n            return Promise.reject(failure(error.response.status, error.message));\n        }\n\n        let data;\n        try {\n            data = parseHttpResponseBody(response.data, response.headers);\n        }\n        catch (error) {\n            return Promise.reject(failure(response.status, error.message));\n        }\n\n        return success(fixHeaders(response.headers), data);\n    }\n\n    cancelRequest(...args) {\n        if (this._cancelRequest) {\n            this._cancelRequest(...args);\n        }\n    }\n\n    updateProgress(progressEvent) {\n        this.emit('progress', progressEvent);\n    }\n\n}\n\nfunction createSignature(credentials, httpMethod, path, params, headers) {\n    let auth = new Auth(credentials.ak, credentials.sk);\n    return auth.generateAuthorization(httpMethod, path, params, headers);\n}\n\nfunction fixHeaders(headers = {}) {\n    return entries(headers).reduce(function (ret, [key, value]) {\n        value = value.trim();\n        if (value) {\n            key = key.toLowerCase();\n            if (key === 'etag') {\n                value = value.replace(/\"/g, '');\n            }\n            ret[key] = value;\n        }\n        return ret;\n    }, {});\n}\n\n\nfunction success(httpHeaders, body) {\n    return {\n        [X_HTTP_HEADERS]: httpHeaders,\n        [X_BODY]: body,\n    };\n}\n\nfunction failure(statusCode, message, code, requestId, xBceDate) {\n    let response = {\n        [X_STATUS_CODE]: statusCode,\n        [X_MESSAGE]: message,\n    };\n\n    if (code) {\n        response[X_CODE] = code;\n    }\n    if (requestId) {\n        response[X_REQUEST_ID] = requestId;\n    }\n    if (xBceDate) {\n        response[X_BCE_DATE] = xBceDate;\n    }\n\n    return response;\n}\n\nfunction parseHttpResponseBody(raw, headers) {\n    var contentType = headers['content-type'];\n\n    if (!raw.length) {\n        return {};\n    }\n    else if (contentType && /^(application|text)\\/json$/i.test(contentType)) {\n        return JSON.parse(raw);\n    }\n    return raw;\n}\n","import {pick, pickBy, includes, startsWith, entries, has, assign, isString} from 'lodash';\nimport Auth from './Auth';\nimport {byteSize, uriEncode, normalizePath} from './strings';\nimport HttpClient from './HttpClient';\nimport EventBus from './EventBus';\nimport {\n    X_BCE_DATE,\n    CONTENT_LENGTH,\n    CONTENT_ENCODING,\n    CONTENT_MD5,\n    X_BCE_CONTENT_SHA256,\n    CONTENT_TYPE,\n    CONTENT_DISPOSITION,\n    ETAG,\n    SESSION_TOKEN,\n    CACHE_CONTROL,\n    EXPIRES,\n    X_BCE_ACL,\n    X_BCE_GRANT_READ,\n    X_BCE_GRANT_FULL_CONTROL,\n    X_BCE_OBJECT_ACL,\n    X_BCE_OBJECT_GRANT_READ,\n    X_CODE,\n    X_STATUS_CODE\n} from './headers';\n\nconst MAX_PUT_OBJECT_LENGTH = 5368709120; // 5G\nconst MAX_USER_METADATA_SIZE = 2048; // 2 * 1024\nconst MIN_PART_NUMBER = 1;\nconst MAX_PART_NUMBER = 10000;\nconst MAX_RETRY_COUNT = 3;\n\nconst allowedHeaders = [\n    CONTENT_LENGTH,\n    CONTENT_ENCODING,\n    CONTENT_MD5,\n    X_BCE_CONTENT_SHA256,\n    CONTENT_TYPE,\n    CONTENT_DISPOSITION,\n    ETAG,\n    SESSION_TOKEN,\n    CACHE_CONTROL,\n    EXPIRES,\n    X_BCE_ACL,\n    X_BCE_GRANT_READ,\n    X_BCE_GRANT_FULL_CONTROL,\n    X_BCE_OBJECT_ACL,\n    X_BCE_OBJECT_GRANT_READ\n];\n\nconst defaultRequestArgs = {\n    bucketName: null,\n    key: null,\n    body: null,\n    headers: {},\n    params: {},\n    config: {}\n};\n\n\nexport default class BosClient extends EventBus {\n    constructor(config) {\n        super();\n        this.config = config;\n    }\n\n    createSignature(credentials, httpMethod, path, params, headers) {\n        let revisionTimestamp = Date.now() + (this.timeOffset || 0);\n        headers[X_BCE_DATE] = new Date(revisionTimestamp).toISOString().replace(/\\.\\d+Z$/, 'Z');\n\n        let auth = new Auth(credentials.ak, credentials.sk);\n        return auth.generateAuthorization(httpMethod, path, params, headers, new Date(revisionTimestamp));\n    }\n\n    generateUrl(bucketName, key) {\n        let resource = normalizePath([\n            '/v1',\n            uriEncode(bucketName || ''),\n            uriEncode(key || '', false)\n        ].join('/'));\n        return this.config.endpoint + resource;\n    }\n\n\n    putObject(bucketName, key, data, options = {}) {\n        if (!key) {\n            throw new TypeError('key should not be empty.');\n        }\n\n        options = this._checkOptions(options);\n\n        return this.sendRequest('PUT', {\n            bucketName: bucketName,\n            key: key,\n            body: data,\n            headers: options.headers,\n            config: options.config\n        });\n    }\n\n    putObjectFromBlob(bucketName, key, blob, options) {\n        let headers = {};\n\n        headers[CONTENT_LENGTH] = blob.size;\n\n        // 对于浏览器调用API的时候，默认不添加 CONTENT_MD5 字段，因为计算起来比较慢\n        // 而且根据 API 文档，这个字段不是必填的。\n        options = assign({}, headers, options);\n\n        return this.putObject(bucketName, key, blob, options);\n    }\n\n\n\n    sendRequest(httpMethod, varArgs) {\n        let args = assign({}, defaultRequestArgs, varArgs);\n        let config = assign({}, this.config, args.config);\n\n        let resource = normalizePath([\n            '/v1',\n            /\\.[\\w\\-]+\\.bcebos\\.com$/.test(config.endpoint) ? '' : uriEncode(args.bucketName || ''),\n            uriEncode(args.key || '', false)\n        ].join('/'));\n\n        if (config.sessionToken) {\n            args.headers[SESSION_TOKEN] = config.sessionToken;\n        }\n\n        return this.sendHTTPRequest(httpMethod, resource, args, config);\n    }\n\n    sendHTTPRequest(httpMethod, resource, args, config) {\n        const httpContext = {\n            httpMethod: httpMethod,\n            resource: resource,\n            args: args,\n            config: config\n        };\n\n        const doRequest = () => {\n            let agent = new HttpClient(config);\n            agent.on('progress', evt => this.emit('progress', evt, httpContext));\n            this.cancelRequest = agent.cancelRequest.bind(agent);\n\n            let promise = agent.sendRequest(\n                httpMethod, resource, args.body, args.headers, args.params,\n                this.createSignature.bind(this)\n            );\n            promise.abort = this.cancelRequest;\n            return promise;\n        };\n\n\n        return doRequest().catch(err => {\n            const serverTimestamp = new Date(err[X_BCE_DATE]).getTime();\n\n            this.timeOffset = serverTimestamp - Date.now();\n\n            if (err[X_STATUS_CODE] === 403 && err[X_CODE] === 'RequestTimeTooSkewed') {\n                return doRequest();\n            }\n\n            if (!isString(err.message)) {\n                err.message = `Unknown error. (${err[X_STATUS_CODE]})`\n            }\n            throw err;\n        });\n    };\n\n    _checkOptions(options, allowedParams) {\n        return {\n            config: options.config || {},\n            headers: this._prepareObjectHeaders(options),\n            params: pick(options, allowedParams || [])\n        };\n    };\n\n    _prepareObjectHeaders(options) {\n        let headers = pickBy(options, (value, key) => includes(allowedHeaders, key) || startsWith(key, 'x-bce-meta-'));\n        let metaSize = entries(headers).reduce((ret, [key, value]) => {\n            return startsWith(key, 'x-bce-meta-') ? ret + byteSize(key + '' + value) : ret;\n        }, 0);\n\n        if (metaSize > MAX_USER_METADATA_SIZE) {\n            throw new TypeError(`Metadata size should not be greater than ${MAX_USER_METADATA_SIZE}.`);\n        }\n\n        if (has(headers, CONTENT_LENGTH)) {\n            let contentLength = headers[CONTENT_LENGTH];\n            if (contentLength < 0) {\n                throw new TypeError('content_length should not be negative.');\n            }\n            else if (contentLength > MAX_PUT_OBJECT_LENGTH) { // 5G\n                // eslint-disable-next-line max-len\n                throw new TypeError(`Object length should be less than ${MAX_PUT_OBJECT_LENGTH}. Use multi-part upload instead.`);\n            }\n        }\n\n        if (has(headers, 'ETag')) {\n            let etag = headers.ETag;\n            if (!/^\"/.test(etag)) {\n                headers.ETag = `\"${etag}\"`\n            }\n        }\n\n        if (!has(headers, CONTENT_TYPE)) {\n            headers[CONTENT_TYPE] = 'application/octet-stream';\n        }\n\n        return headers;\n    }\n\n\n    // initiateMultipartUpload(bucketName, key, options) {\n    //     options = options || {};\n\n    //     var headers = {};\n    //     headers[H.CONTENT_TYPE] = MimeType.guess(path.extname(key));\n\n    //     options = this._checkOptions(u.extend(headers, options));\n\n    //     return this.sendRequest('POST', {\n    //         bucketName: bucketName,\n    //         key: key,\n    //         params: {uploads: ''},\n    //         headers: options.headers,\n    //         config: options.config\n    //     });\n    // }\n\n    // abortMultipartUpload(bucketName, key, uploadId, options) {\n    //     options = options || {};\n\n    //     return this.sendRequest('DELETE', {\n    //         bucketName: bucketName,\n    //         key: key,\n    //         params: {uploadId: uploadId},\n    //         config: options.config\n    //     });\n    // }\n\n    // completeMultipartUpload(bucketName, key, uploadId, partList, options) {\n    //     var headers = {};\n    //     headers[H.CONTENT_TYPE] = 'application/json; charset=UTF-8';\n    //     options = this._checkOptions(u.extend(headers, options));\n\n    //     return this.sendRequest('POST', {\n    //         bucketName: bucketName,\n    //         key: key,\n    //         body: JSON.stringify({parts: partList}),\n    //         headers: options.headers,\n    //         params: {uploadId: uploadId},\n    //         config: options.config\n    //     });\n    // }\n\n\n    // uploadPartFromBlob(bucketName, key, uploadId, partNumber,\n    //                                                    partSize, blob, options) {\n    //     if (blob.size !== partSize) {\n    //         throw new TypeError(util.format('Invalid partSize %d and data length %d',\n    //             partSize, blob.size));\n    //     }\n\n    //     var headers = {};\n    //     headers[H.CONTENT_LENGTH] = partSize;\n    //     headers[H.CONTENT_TYPE] = 'application/octet-stream';\n    //     // 对于浏览器调用API的时候，默认不添加 H.CONTENT_MD5 字段，因为计算起来比较慢\n    //     // headers[H.CONTENT_MD5] = require('./crypto').md5sum(data);\n\n    //     options = this._checkOptions(u.extend(headers, options));\n    //     return this.sendRequest('PUT', {\n    //         bucketName: bucketName,\n    //         key: key,\n    //         body: blob,\n    //         headers: options.headers,\n    //         params: {\n    //             partNumber: partNumber,\n    //             uploadId: uploadId\n    //         },\n    //         config: options.config\n    //     });\n    // }\n\n    // listParts(bucketName, key, uploadId, options) {\n    //     /* eslint-disable */\n    //     if (!uploadId) {\n    //         throw new TypeError('uploadId should not empty');\n    //     }\n    //     /* eslint-enable */\n\n    //     var allowedParams = ['maxParts', 'partNumberMarker', 'uploadId'];\n    //     options = this._checkOptions(options || {}, allowedParams);\n    //     options.params.uploadId = uploadId;\n\n    //     return this.sendRequest('GET', {\n    //         bucketName: bucketName,\n    //         key: key,\n    //         params: options.params,\n    //         config: options.config\n    //     });\n    // }\n\n}\n\n\n\n\n\n\n\n\n\n\n\n","<template>\n  <div id=\"app\">\n      <h1>BosClient.putObjectFromBlob()</h1>\n      <div>\n        <input type=\"file\" @change=\"handleFileChange\" :disabled=\"isUploading\" />\n        <button @click=\"handleUploadButtonClick\" :disabled=\"!file || isUploading\">Upload</button>\n        <button @click=\"handleCancelButtonClick\" v-if=\"file && isUploading\">Cancel</button>\n      </div>\n      <div class=\"loading\" v-if=\"isUploading\">上传中 {{ progressText }}</div>\n      <div class=\"error\" v-if=\"isFail\">上传失败：{{ error }}</div>\n      <div class=\"success\" v-if=\"isSuccess\">上传成功!\n        <a :href=\"url\" target=\"_blank\">打开</a>\n      </div>\n  </div>\n</template>\n\n<script>\nimport {nanoid} from 'nanoid';\nimport {BosClient} from 'bce-sdk-lite-local';\n\nconst ak = process.env.BCE_AK;\nconst sk = process.env.BCE_SK;\nconst sessionToken = process.env.BCE_ST;\n\n// const BosClient = window.baidubce.sdk.BosClient;\nconst bucket = process.env.BOS_BUCKET;\n\nexport default {\n  name: 'App',\n  data() {\n    return {\n      file: null,\n      status: 0,\n      error: '',\n      progress: 0,\n    }\n  },\n  computed: {\n    isUploading() {\n      return this.status === 1;\n    },\n    isFail() {\n      return this.status === 3;\n    },\n    isSuccess() {\n      return this.status === 2;\n    },\n    progressText() {\n      return Math.round(this.progress * 100) + '%';\n    }\n  },\n  methods: {\n    handleFileChange(evt) {\n      this.file = evt.target.files[0];\n    },\n    async handleUploadButtonClick() {\n      let ext = getExt(this.file.name);\n      let key = `test/${nanoid()}${ext}`;\n      this.status = 1;\n      try {\n        await this.client.putObjectFromBlob(bucket, key, this.file, {\n          'Content-Type': getContentType(ext)\n        });\n      }\n      catch (err) {\n        this.status = 3;\n        this.error = err.message;\n        console.log(err);\n        return;\n      }\n      this.status = 2;\n      this.url = this.client.generateUrl(bucket, key);\n    },\n    handleClientProgress({loaded, total}) {\n      this.progress = loaded / total;\n    },\n    handleCancelButtonClick() {\n      if (this.client.cancelRequest) {\n        this.client.cancelRequest('User cancelled uploading');\n      }\n    },\n  },\n  mounted() {\n    const client = new BosClient({\n      sessionToken,\n      endpoint: 'https://bj.bcebos.com',\n      credentials: {ak, sk},\n    });\n    client.on('progress', this.handleClientProgress.bind(this));\n    this.client = client;\n  },\n  beforeDestroy() {\n    this.client.off('progress');\n    if (this.cancelRequest) {\n      this.cancelRequest();\n    }\n  }\n}\n\nfunction getExt(name) {\n  let i = name.lastIndexOf('.');\n  if (i < 0) {\n    return '';\n  }\n  return name.substring(i);\n}\n\nfunction getContentType(ext) {\n  if (['.jpeg', '.jpg', '.png', '.webp', '.gif'].includes(ext)) {\n    return `image/${ext.substring(1)}`;\n  }\n  if (['.mp4', '.mov'].includes(ext)) {\n    return `video/${ext.substring(1)}`;\n  }\n  if (['.mp3', '.m4a', '.opus'].includes(ext)) {\n    return `audio/${ext.substring(1)}`;\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n\n#app > div {\n  margin: 20px 0;\n}\n\nh1 {\n  font-family: monospace;\n  font-size: 1.5em;\n  font-weight: normal;\n}\n\n.error {\n  color: red;\n}\n.success {\n  color: green;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=6b0427b4&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n\n\n\n\n\n"],"sourceRoot":""}